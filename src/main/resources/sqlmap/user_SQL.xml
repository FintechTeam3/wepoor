<?xml version="1.0" encoding="UTF-8"?>

<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hk.wepoor.model.UserMapper">
	<resultMap id="memberResultMap" type="UserVO">
        <id column="user_no" property="userNo"/>
        <result column="user_id" property="userId"/>
        <result column="user_pwd" property="userPwd"/>
        <result column="user_name" property="userName"/>
        <result column="user_nickname" property="userNickname"/>
        <result column="user_phone" property="userPhone"/>
        <result column="user_seq_no" property="userSeqNo"/>
        <result column="access_token" property="accessToken"/>
        <result column="refresh_token" property="refreshToken"/>
    </resultMap>
    
     <select id="getUserNo" resultType="UserVO">
        <![CDATA[
        SELECT user_no as userNo, user_name as userName, user_seq_no as userSeqNo, access_token as accessToken
        FROM user
        where access_token is not null
        ]]>
    </select>
    
	<insert id="insertUser" parameterType="com.hk.wepoor.vo.UserVO">
        <![CDATA[
        INSERT INTO user (user_id, user_pwd, user_name, user_nickname, user_phone, user_seq_no, access_token, refresh_token)
        VALUES (#{userId}, SHA2(#{userPwd}, 256), #{userName}, #{userNickname}, #{userPhone}, #{userSeqNo}, #{accessToken}, #{refreshToken})
    	]]>
	</insert>

	<select id="getUserByUserId" parameterType="String" resultMap="memberResultMap">
        <![CDATA[
        SELECT * FROM user WHERE user_id = #{userId}
    	]]>
	</select>

	<select id="getUserByUserNo" parameterType="int" resultMap="memberResultMap">
        <![CDATA[
        SELECT * FROM user WHERE user_no = #{userNo}
        ]]>
	</select>

	<select id="getAllUsers" resultType="hashmap">
        <![CDATA[
        SELECT * FROM user
        ]]>
	</select>

	<select id="HashedPwd" resultType="string">
		<![CDATA[
        SELECT SHA2(#{userPwd}, 256)
    	]]>
	</select>

	<update id="updateUser" parameterType="com.hk.wepoor.vo.UserVO">
        <![CDATA[
        UPDATE user SET
        user_id = #{userId},
<<<<<<< HEAD
        cate_id = #{cateId}
=======
>>>>>>> refs/heads/parkhyejung
        user_pwd = SHA2(#{userPwd}, 256),
        user_name = #{userName},
        user_nickname = #{userNickname},
        user_phone = #{userPhone},
        user_point = #{userPoint}
        WHERE user_no = #{userNo}
    	]]>
	</update>
	
	<update id="updateMy" parameterType="com.hk.wepoor.vo.UserVO">
        <![CDATA[
        UPDATE user SET
        user_pwd = SHA2(#{userPwd}, 256),
        user_nickname = #{userNickname}
        WHERE user_no = #{userNo}
    	]]>
	</update>

	<delete id="deleteUser" parameterType="int">
    	<![CDATA[
        DELETE FROM user WHERE user_no = #{userNo}
        ]]>
	</delete>
	
	<select id = "getAllUserId" resultType="hashmap">
		<![CDATA[
        SELECT user_id FROM user;
        ]]>
	</select>
<<<<<<< HEAD
=======
	
	<select id = "getUserNick" parameterType="String" resultMap="memberResultMap">
		<![CDATA[
        SELECT * FROM user WHERE user_nickname = #{user_nickname}
        ]]>
	</select>
	
	
>>>>>>> refs/heads/parkhyejung
</mapper>